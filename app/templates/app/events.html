{% extends "base.html" %}
{% load static %}
{% load tz %}

{% block title %}Eventos{% endblock %}

{% block content %}
<style>
  
  .event-card .ratio > img { object-fit: cover; }
  .event-card:hover { transform: translateY(-3px); transition: transform .2s ease; }
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;  
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  body {
    background: url("{% static 'images/foto_home.jpeg' %}");
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    
  }
  .eventos-section .overlay {
    background-color: rgba(0,0,0,0.55); 
    min-height: 100vh;
    padding: 2rem;
  }
</style>

<div class="eventos-section">
  <div class="overlay">
    <div class="row g-3">
      {% for event in events %}
        <div class="col-6 col-md-3">
          <div class="card h-100 shadow-sm event-card">

            <a href="{% url 'event_detail' event.id %}" class="text-decoration-none text-reset">
              <div class="ratio ratio-4x3">
                <img
                  src="{% if event.image %}{{ event.image.url }}{% else %}{% static 'img/event-placeholder.jpg' %}{% endif %}"
                  alt="Evento {{ event.title }}"
                  class="w-100 h-100"
                  loading="lazy"
                />
              </div>
            </a>

            <div class="card-body">
              <h6 class="card-title mb-1 line-clamp-2" title="{{ event.title }}">
                {{ event.title }}
              </h6>

              <div class="small text-muted">
                {{ event.date|date:"d/m/Y H:i" }}
              </div>

              <div class="small">
                {{ event.venue.name }}
              </div>

              <div class="fw-semibold mt-1">
                {% if event.prize and event.prize > 0 %}
                  ${{ event.prize }}
                {% else %}
                  Entrada libre
                {% endif %}
              </div>

              <div class="mt-2">
                <span class="badge bg-light text-dark">{{ event.category.name }}</span>
              </div>
            </div>

            <div class="card-footer bg-white border-0 pt-0 pb-3 px-3">
              <div class="d-flex gap-2">
                <a href="{% url 'event_detail' event.id %}" class="btn btn-sm btn-primary w-100">
                  Comprar
                </a>
              </div>
            </div>

          </div>
        </div>
      {% empty %}
        <p class="text-white">No hay eventos disponibles.</p>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
